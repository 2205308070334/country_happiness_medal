# 


## 1

import pandas as pd

# Load the uploaded file to explore its structure
file_path = '/mnt/data/World Happiness Research Raw Join Tables.xlsx'
excel_data = pd.ExcelFile(file_path)

# Check sheet names to understand the data structure
excel_data.sheet_names

## 2

# Load the relevant sheet into a DataFrame
df = pd.read_excel(file_path, sheet_name='raw_join_2024Medal_and_2024WHR')

# Display the first few rows of the dataset to understand its structure
df.head()
  
The dataset provides information on World Happiness Report (WHR) scores, Olympic medals for various countries, and several happiness score components (like GDP, social support, and more). Here's a plan to extract five insightful analyses, especially correlating World Happiness and Olympic success:

Correlation between Total Medals and Happiness Scores: We'll assess if countries with more Olympic medals tend to have higher ladder scores in the World Happiness Report.

Impact of Economic Prosperity (Log GDP per Capita) and Medal Success: Investigating whether countries with higher GDP per capita also perform better in the Olympics.

Social Support and Olympic Performance: Examine if stronger social support (as indicated in the WHR) is related to better Olympic performance.

Healthy Life Expectancy vs Medal Counts: We'll look into how life expectancy might correlate with Olympic success, considering that nations with healthier populations may invest more in sports.

Perceptions of Corruption and Medal Success: Analyze if lower perceived corruption correlates with higher medal counts, exploring potential systemic factors influencing sports success.

I'll start by calculating correlations between these variables and provide visual insights on these relationships. Let's begin with a general correlation analysis between the main happiness metrics and Olympic medals.  

## 3

correlation_data = df[['total_medals', 'Ladder score', 'Explained by: Log GDP per capita', 
                       'Explained by: Social support', 'Explained by: Healthy life expectancy', 
                       'Explained by: Perceptions of corruption']]

# Calculating the correlation matrix
correlation_matrix = correlation_data.corr()

# Display the correlation matrix to analyze relationships
correlation_matrix
